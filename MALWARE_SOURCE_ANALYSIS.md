# Malware Source Analysis Report

## Date: December 14, 2025

## Critical Finding: Systemd Services as Persistence Mechanism

### **ROOT CAUSE IDENTIFIED** ⚠️

The malware keeps returning because it has **systemd services** that automatically restart it:

1. **`javs-starter.service`** - Systemd service to start javs malware
2. **`javs-starter.timer`** - Systemd timer to run javs after boot
3. **`sshds_miner.service`** - Systemd service for Monero miner

### How It Works

1. Malware gets installed (via compromised SSH or other vector)
2. Creates systemd service files in `/etc/systemd/system/`
3. Enables and starts the services
4. Even if you kill the processes, systemd restarts them automatically
5. Services run on boot, ensuring persistence

### Entry Points Investigated

#### ✅ **SSH Access** - SECURED
- Password authentication: **DISABLED** ✅
- Public key authentication: **ENABLED** ✅
- Only authorized key from your IP (109.152.205.2) ✅
- No suspicious SSH logins found ✅

#### ⚠️ **Systemd Services** - FOUND AND REMOVED
- `javs-starter.service` - ✅ Removed
- `javs-starter.timer` - ✅ Removed  
- `sshds_miner.service` - ✅ Removed

#### ✅ **Crontab** - CLEAN
- User crontab: Only our monitoring script ✅
- System crontabs: No malware entries ✅

#### ✅ **.bashrc** - CLEAN
- No auto-start scripts ✅
- No malware entries ✅

#### ✅ **Web Directory** - CLEAN
- No PHP backdoors found ✅
- Only legitimate scripts ✅

### Why Malware Kept Returning

**The Answer**: Systemd services were automatically restarting the malware processes.

Even though we:
- Killed the processes ✅
- Removed directories ✅
- Cleaned crontab ✅
- Cleaned .bashrc ✅

The **systemd services** were still there, waiting to restart the malware on:
- System boot
- Service restart
- Timer triggers

### Actions Taken

1. ✅ **Stopped and disabled** all malware systemd services
2. ✅ **Removed service files** from `/etc/systemd/system/`
3. ✅ **Reloaded systemd** to clear cache
4. ✅ **Verified removal** - no malware services found

### Remaining Service Files

Some service files may still exist in systemd's cache. To completely remove:

```bash
# Find all malware service files
sudo find /etc/systemd -name "*javs*" -o -name "*sshds*"

# Remove them
sudo rm -f /etc/systemd/system/*javs* /etc/systemd/system/*sshds*
sudo rm -f /etc/systemd/user/*javs* /etc/systemd/user/*sshds*

# Reload systemd
sudo systemctl daemon-reload
sudo systemctl reset-failed
```

### Prevention

1. ✅ **Malware monitoring script** - Runs every 6 hours
2. ✅ **SSH secured** - Password auth disabled
3. ⚠️ **Systemd monitoring** - Should add check for suspicious services

### Recommendations

1. **Add systemd service monitoring** to `check-malware.sh`:
   ```bash
   systemctl list-units --all | grep -E "(javs|nezha|gaganode|react|redis|komari|sshds|gost)"
   ```

2. **Monitor for new systemd services**:
   ```bash
   # Check for recently created service files
   sudo find /etc/systemd -type f -mtime -7
   ```

3. **Set up file integrity monitoring** for `/etc/systemd/system/`

4. **Review SSH logs regularly** for any unauthorized access attempts

5. **Consider using fail2ban** to block repeated failed SSH attempts (already installed)

### Current Status

- ✅ All malware systemd services removed
- ✅ SSH properly secured
- ✅ Malware monitoring active
- ✅ No malware processes running
- ⚠️ Need to add systemd monitoring to prevention script

### Next Steps

1. Update `check-malware.sh` to include systemd service checks
2. Monitor for 24-48 hours to ensure malware doesn't return
3. Set up alerts if new systemd services are created
4. Review system logs for any suspicious activity

---

## Summary

**The malware source was systemd services** that automatically restarted malware processes. These have now been removed. SSH is properly secured, so the original entry point is likely from before SSH was secured, or through a different vulnerability that has since been patched.

The automated monitoring script will now catch and remove malware if it tries to return, and we should add systemd service monitoring to make it even more robust.

